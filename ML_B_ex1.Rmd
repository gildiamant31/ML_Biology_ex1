---
title: "ML_B_ex1"
author: "itamar_living in dream, Yishay is donkey"
date: "29 3 2022"
output: pdf_document
---


setup & configure of the plots (each plot present in different figure)
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE, fig.width=8, fig.height=3)
```


load all relevant libraries for using on EDA:
```{r echo=FALSE}
library(ggplot2) # load the ggplot2 library
library(dplyr)
library(tidyverse)
library(scales)
```

import the dataset to a local variable called surveys:
```{r echo=FALSE}
surveys <- read_csv("netflix-rotten-tomatoes-metacritic-imdb.csv")
```

Firstly, lets observe the properties of the data for getting ideas for graphs -

```{r}
dim(surveys)

names(surveys)  
```
Editing the table for our EDA
 
```{r}

# separate the release-date to day month and year columns - it is easier to
# use this column like this and convert year column to numeric 
surveys_fixed <- surveys %>% separate(`Release Date`, c("day", "month", "year"), sep = " ", convert = TRUE)
# convert 
surveys_fixed$`Netflix Release Date` <- as.Date(surveys$`Netflix Release Date`)
# convert the income to integer
surveys_fixed$Boxoffice = gsub("\\$", "", surveys_fixed$Boxoffice)
surveys_fixed$Boxoffice = gsub("\\,", "", surveys_fixed$Boxoffice)
surveys_fixed$Boxoffice = as.numeric(surveys_fixed$Boxoffice)
#remove NA from box
surveys_fixed_no_box_NA <- subset(surveys_fixed, !is.na(Boxoffice))
# לפרסר למספרי את הערך של זמן הסרט
# surveys_fixed$Runtime[surveys$Runtime == "1-2 hour"] <- "1.5"
# surveys_fixed$Runtime[surveys$Runtime == "< 30 minutes"] <- "0.5"
# surveys_fixed$Runtime[surveys$Runtime == "> 2 hrs"] <- "2"
# surveys_fixed$Runtime[surveys$Runtime == "30-60 mins"] <- "1"
# surveys_fixed$Runtime <- as.numeric(surveys_fixed$Runtime)

# Remove all  rows which contain comma in Genere column - throw away to many rows
surveys_fixed_one_genre <- surveys_fixed[!grepl(",", surveys_fixed$Genre), ]

# בחירת עמודות- סתם דוגמאות
#surveys_selected <- select(surveys, where(is.numeric))
#surveys_selected <- select(surveys, !starts_with("Link"))

# בחירת שורות סתם דוגמאות 
#surveys_selected <- surveys %>% filter( grepl("Action", Genre) & `Series or Movie` == "Movie")

# הורדת שורות עם NA
surveys <- subset(surveys, !is.na(Runtime))
surveys_fixed$Genre <- sub('.*,\\s*', '', surveys_fixed$Genre)


# ספירת מספר מופעים של תוכן
surveys %>% group_by(Runtime) %>%  tally(sort = TRUE)
```
We wanted to check the correlation between the movie's language and the movie's time length. From results we conclude interesting findings:
- in English most common movies are 1-2 hours length
- in Korean there are no short movies (=less then 1 hours)
- in Hinde there is no medium movies (= 30-60 minutes)
```{r}

one_lan <- surveys_fixed %>% filter((Languages=="English" | Languages=="Japanese" | Languages=="Korean" | Languages=="Spanish" | Languages=="Hindi" | Languages=="French" | Languages=="German")& (`Series or Movie`=="Movie"))

# one_lan$Runtime[one_lan$Runtime == "1-2 hour"] <- "1.5"
# one_lan$Runtime[one_lan$Runtime == "< 30 minutes"] <- "0.5"
# one_lan$Runtime[one_lan$Runtime == "> 2 hrs"] <- "2"
# one_lan$Runtime[one_lan$Runtime == "30-60 mins"] <- "1"
# one_lan$Runtime <- as.numeric(one_lan$Runtime)


ggplot(data = one_lan, aes(x=Languages, y=Runtime)) + geom_count()
  labs(title = "Counting movies of a certain length per Language")
```
Hidden gem score is a measurement for an putative unknown good movie. We wanted to explore whether the unknown good movies is also counted as good movies in the general IMDB score.
The results shows that there is movies with mid gem-score but with very low IMDB score which means there are probably bad movies. but the movies with the high gem score are mostly have very good IMDB-score
```{r}

# אפשר לומר שיש פה 2 קבוצות - כאלה עם ממש מעט הצבעות וציון לא משהו וכאלה שבאמת יש להם ציון טוב
# plotting a scatter plot איתמר תסביר מה עשית פה
ggplot(data = surveys,  aes(y =`IMDb Score` , x= `Hidden Gem Score`)) +
  geom_point() + theme_classic() +
  labs(title = "IMDb Score vs Hidden Gem Score")
```



```{r}

# Movie vs Series on boxoffice in Billion dollars
ggplot(data = surveys_fixed , aes(x=Boxoffice, y=`Series or Movie` , fill = `Series or Movie`)) +
  geom_col() + 
  scale_x_continuous(labels = label_number(suffix = " B", scale = 1e-9))+ 
  labs(title = "Movie Vs Series by Revenues in Bilion USD",
  y = "Movie or Series", x = "Revenues (USD)")

# Revenues by Genres in Billion dollars 
ggplot(data = surveys_fixed ,mapping = aes(x=Boxoffice, y= Genre, fill = Genre)) +
  geom_col() + 
  scale_x_continuous(labels = label_number(suffix = "B", scale = 1e-9))+ 
  labs(title = "Compare Revenues of all Genres in Bilion USD",
  y = "Genres", x = "Revenues (USD)")


# creating boxplot
ggplot(data = surveys, mapping = aes(x = `IMDb Score`, y = `Hidden Gem Score`)) + 
  geom_boxplot(mapping = aes(group = cut_width(`IMDb Score`, 0.1)))

# We wanted to check what is category with the average best IMDB score. From results we can see that Drama category gets the best IMDB score average. 
ggplot(data = surveys_fixed) +
  geom_count(mapping = aes(x = "IMDb Score", y = Genre)) + labs(title= "Average IMDB score per Genre")

# Sum of Genres per years
ggplot(surveys_fixed,aes(x = year, color = Genre)) + 
     geom_line(stat = 'count') +
  labs( title = "Sum of per gener over the year",
  y = "Genres", x = "Years")

```


## Data Visualisation - 

```{r}

surveys$`Hidden Gem Score` <- as.numeric(surveys$`Hidden Gem Score`)
ggplot(data = surveys) +
  geom_histogram(mapping = aes(x = `Hidden Gem Score`), binwidth = 0.5)

ggplot(data = surveys , color = Runtime) + 
  geom_bar(mapping = aes(x = Runtime, fill = Runtime))

```



```{r}
unique(surveys$`Series or Movie`)
surveys$Num_of_country <- lapply(surveys$`Country Availability`, function(x){length(strsplit(x,","))})
surveys$Num_of_country <- toString(surveys$Num_of_country)
class(surveys$Num_of_country)
ggplot(data = surveys) + 
  geom_bar(mapping = aes(x = Num_of_country))

surveys$a <- 0
ggplot(data = surveys[surveys$`Country Availability` == "France",],  aes(y = `Hidden Gem Score`, x= `Series or Movie`,  fill = `Series or Movie`)) +
  geom_boxplot()  +theme_classic() + labs(title= "blabla")

```

