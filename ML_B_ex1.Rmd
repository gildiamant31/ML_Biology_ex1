---
title: "ML_B_ex1"
author: "itamar_living in dream, Yishay is donkey"
date: "29 3 2022"
output: pdf_document
---


setup & configure of the plots (each plot present in different figure)
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE, fig.width=8, fig.height=3)
```


load all relevant libraries for using on EDA:
```{r}
library(ggplot2) # load the ggplot2 library
library(dplyr)
library(tidyverse)
library(scales)
```

import the dataset to a local variable called surveys:
```{r}
surveys <- read_csv("netflix-rotten-tomatoes-metacritic-imdb.csv")
```

Some information is already known to us just from calling the table. We know how many rows and columns there are, and we have some idea regarding the type of variables (text, numeric) but not much else.

We use few commands to get more information about the data and got table dimension, names of columns and basic summary of the data in the table:

```{r}
dim(surveys)

names(surveys)  

summary(surveys) 
```

פקודות שימושיות 
```{r}

# separate the real release date to day month and year columns - it is easier to
# use this column like this.
surveys_fixed <- surveys %>% separate(`Release Date`, c("day", "month", "year"), sep = " ", convert = TRUE)
# convert year column to numeric - ignore n/a rows.
surveys_fixed$year = as.numeric(surveys_fixed$year)
surveys_fixed$`Netflix Release Date` <- as.Date(surveys$`Netflix Release Date`)
surveys_fixed$Boxoffice = gsub("\\$", "", surveys_fixed$Boxoffice)
surveys_fixed$Boxoffice = gsub("\\,", "", surveys_fixed$Boxoffice)
surveys_fixed$Boxoffice = as.numeric(surveys_fixed$Boxoffice)
surveys_fixed <- subset(surveys_fixed, !is.na(Boxoffice))
# לפרסר למספרי את הערך של זמן הסרט
surveys$Runtime[surveys$Runtime == "1-2 hour"] <- "1.5"
surveys$Runtime[surveys$Runtime == "< 30 minutes"] <- "0.5"
surveys$Runtime[surveys$Runtime == "> 2 hrs"] <- "2"
surveys$Runtime[surveys$Runtime == "30-60 mins"] <- "1"
#surveys$Runtime <- as.numeric(surveys$Runtime)

# Remove all  rows which contain comma in Genere column 
surveys_fixed <- surveys_fixed[!grepl(",", surveys_fixed$Genre), ]

# בחירת עמודות- סתם דוגמאות
#surveys_selected <- select(surveys, where(is.numeric))
#surveys_selected <- select(surveys, !starts_with("Link"))

# בחירת שורות סתם דוגמאות 
#surveys_selected <- surveys %>% filter( grepl("Action", Genre) & `Series or Movie` == "Movie")

# הורדת שורות עם NA
surveys <- subset(surveys, !is.na(Runtime))

# ספירת מספר מופעים של תוכן
surveys %>% group_by(Runtime) %>%  tally(sort = TRUE)




```

## Data Variation

One important fact to know about our data is its variation, can you think of reasons why? 



```{r}

# אפשר לומר שיש פה 2 קבוצות - כאלה עם ממש מעט הצבעות וציון לא משהו וכאלה שבאמת יש להם ציון טוב
# plotting a scatter plot 
ggplot(data = surveys,  aes(y = `Hidden Gem Score`, x= `IMDb Score`)) +
  geom_point() + theme_classic()

one_lan <- surveys %>% filter(Languages=="English" | Languages=="Japanese" | Languages=="Korean" | Languages=="Spanish" | Languages=="Hindi" | Languages=="French" | Languages=="German")

ggplot(data = one_lan, aes(x=Languages, y=Runtime)) + geom_count()

# Movie vs Series on boxoffice in Billion dollars 
ggplot(data = surveys_fixed , aes(x=Boxoffice, y=`Series or Movie` , fill = `Series or Movie`)) +
  geom_col() + 
  scale_x_continuous(labels = label_number(suffix = " B", scale = 1e-9))+ 
  labs( title = "Movie Vs Series by Revenues in Bilion USD",
  y = "Movie or Series", x = "Revenues (USD)")

# Revenues by Genres in Billion dollars 
ggplot(data = surveys_fixed ,mapping = aes(x=Boxoffice, y= Genre, fill = Genre)) +
  geom_col() + 
  scale_x_continuous(labels = label_number(suffix = " B", scale = 1e-9))+ 
  labs( title = "Compare Revenues of all Genres in Bilion USD",
  y = "Genres", x = "Revenues (USD)")


# creating boxplot
ggplot(data = surveys, mapping = aes(x = `IMDb Score`, y = `Hidden Gem Score`)) + 
  geom_boxplot(mapping = aes(group = cut_width(`IMDb Score`, 0.1)))

# Variance between two categorical variables
ggplot(data = surveys_fixed) +
  geom_count(mapping = aes(x = "IMDb Score", y = Genre))

# Sum of Genres per years
ggplot(surveys_fixed,aes(x = year, color = Genre)) + 
     geom_line(stat = 'count')

```


## Data Visualisation - 

```{r}

surveys$`Hidden Gem Score` <- as.numeric(surveys$`Hidden Gem Score`)
ggplot(data = surveys) +
  geom_histogram(mapping = aes(x = `Hidden Gem Score`), binwidth = 0.5)

ggplot(data = surveys , color = Runtime) + 
  geom_bar(mapping = aes(x = Runtime, fill = Runtime))

```



```{r}
unique(surveys$`Series or Movie`)
lapply(surveys$`Country Availability`, function(x){length(unlist(strsplit(x,",")))})
surveys2$a <- 0
ggplot(data = surveys[surveys$`Country Availability` == "Canada",],  aes(y = `Hidden Gem Score`, x= `Series or Movie`,  fill = `Series or Movie`)) +
  geom_boxplot()  +theme_classic() + labs(title= "blabla")

```

