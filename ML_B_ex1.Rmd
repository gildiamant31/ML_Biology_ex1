---
title: "ML_B_ex1"
author: "Gil Diamant, Yishay Shlezinger & Itamar Twersky"
date: "08 4 2022"
output: pdf_document
---


setup & configure of the plots (each plot present in different figure)
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE, fig.width=8, fig.height=3)
```


load all relevant libraries for using on EDA:
```{r echo=FALSE}
library(ggplot2) # load the ggplot2 library
library(dplyr)
library(tidyverse)
library(scales)
```

import the dataset to a local variable called surveys:
```{r echo=FALSE}
surveys <- read_csv("netflix-rotten-tomatoes-metacritic-imdb.csv")
```

Firstly, lets observe the properties of the data for getting ideas for EDA -

```{r}
dim(surveys)

names(surveys)  
```
Editing the table for our EDA
 
```{r}
## helpful commands

להשוות בין סוגי הדירוגים
קשר בין דירוג לכמות פרסים
יחס בין דירוג להכנסות
כמות הצבעות מול גובה הציון 


# separate the release-date to day month and year columns - it is easier to
# use this column like this and convert year column to numeric 
#surveys_fixed <- surveys %>% separate(`Release Date`, c("day", "month", "year"), sep = " ", convert = TRUE)
# convert 
#surveys_fixed$`Netflix Release Date` <- as.Date(surveys$`Netflix Release Date`)
# convert the income to integer
#surveys_fixed$Boxoffice = gsub("\\$", "", surveys_fixed$Boxoffice)
#surveys_fixed$Boxoffice = gsub("\\,", "", surveys_fixed$Boxoffice)
#surveys_fixed$Boxoffice = as.numeric(surveys_fixed$Boxoffice)
#remove NA from box
#surveys_fixed_no_box_NA <- subset(surveys_fixed, !is.na(Boxoffice))
#
# surveys_fixed$Runtime[surveys$Runtime == "1-2 hour"] <- "1.5"
# surveys_fixed$Runtime[surveys$Runtime == "< 30 minutes"] <- "0.5"
# surveys_fixed$Runtime[surveys$Runtime == "> 2 hrs"] <- "2"
# surveys_fixed$Runtime[surveys$Runtime == "30-60 mins"] <- "1"
# surveys_fixed$Runtime <- as.numeric(surveys_fixed$Runtime)

# Remove all  rows which contain comma in Genere column - throw away to many rows
#surveys_fixed_one_genre <- surveys_fixed[!grepl(",", surveys_fixed$Genre), ]

#
#surveys_selected <- select(surveys, where(is.numeric))
#surveys_selected <- select(surveys, !starts_with("Link"))

#  
#surveys_selected <- surveys %>% filter( grepl("Action", Genre) & `Series or Movie` == "Movie")

#
#surveys <- subset(surveys, !is.na(Runtime))
#surveys_fixed$Genre <- sub('.*,\\s*', '', surveys_fixed$Genre)


#surveys %>% group_by(Runtime) %>%  tally(sort = TRUE)
```

In the data, there are movie scores from three different sites - IMDb, Rotten Tomatoes and Metacritic.
we checked the relation between three different sites' scores/ 

```{r}

```

The Disribution of the 3 scores also tell a lot about the sites' scores

```{r}

ggplot(data = surveys) +
  geom_histogram(mapping = aes(x = `IMDb Score`), fill="steelblue", binwidth = 0.5) + geom_histogram(mapping = aes(x = surveys$`Rotten Tomatoes Score`/10), fill="darkred", binwidth = 0.5) + geom_histogram(mapping = aes(x = surveys$`Metacritic Score`/10), fill="blueviolet", binwidth = 0.5)


```


After  the relation between scores we wanted check whether high-score movies yield more revenues


```{r}

```


We were also interesed whether high score movies are tend to be more popular and therefore will have more votes


```{r}

```


Last thing to look at about the score, is if an high score cause more Awards?

```{r}

```





We was interest to check the distribution of length of movies

```{r}
surveys_movies <- surveys %>% filter(`Series or Movie` == 'Movie')
ggplot(data = surveys_movies , color = Runtime) + 
  geom_bar(mapping = aes(x = Runtime, fill = Runtime))+
  labs( title = "Sum per runtime")
```

We assume that movies with a certain language are have properties that represent the culture the language belong to. 
One property that can be related to a culture is the movie length. check the correlation between the movie's language and the movie's time length. 
we looked for the top 5 popular languages, and check for them.
From results we conclude interesting findings:
- the movies in languages of countries with more western culture (English,French,Spanish,Italian) tend to be with length of 1-2 hours while movies with other languages are have also significant piece of longer(>2) movies.
that may point out that the western culture are tend to be less patient to see a long movie
```{r}
surveys_movies %>% group_by(Languages) %>%  tally(sort = TRUE) %>% head(10)

surveys_movies_fixed_runtime <- surveys_movies

surveys_movies_fixed_runtime$Runtime[surveys_movies_fixed_runtime$Runtime == "1-2 hour"] <- "1.5"
surveys_movies_fixed_runtime$Runtime[surveys_movies_fixed_runtime$Runtime == "< 30 minutes"] <- "0.3"
surveys_movies_fixed_runtime$Runtime[surveys_movies_fixed_runtime$Runtime == "> 2 hrs"] <- "2.5"
surveys_movies_fixed_runtime$Runtime[surveys_movies_fixed_runtime$Runtime == "30-60 mins"] <- "0.7"
surveys_movies_fixed_runtime$Runtime <- as.numeric(surveys_movies_fixed_runtime$Runtime)

one_lan <- surveys_movies_fixed_runtime %>% filter(Languages=="English" | Languages=="Japanese" | Languages=="Korean" | Languages=="Spanish" | Languages=="Hindi" | Languages=="French" | Languages=="Italian")

ggplot(data = one_lan, aes(x=Languages, y=Runtime, fill=Languages)) + geom_violin()+ geom_point()+
  theme_bw() +
  labs(title = "Counting movies of a certain length per Language")

```

Hidden gem score is a measurement for an putative unknown good movie. We wanted to explore whether the unknown good movies is also counted as good movies in the general IMDB score.
The results of those two plots show us that there is movies with mid gem-score but with very low IMDB score which means there are probably bad movies. but the movies with the high gem score are mostly have very good IMDB-score
```{r}

ggplot(data = surveys,  aes(y =`IMDb Score` , x= `Hidden Gem Score`, color=`IMDb Score`)) +
  geom_point() + theme_classic() +
  labs(title = "IMDb Score vs Hidden Gem Score")
```



In this plot , We wanted to check the differences in revenues (Boxoffice) between movies & series.
we manipulate the Boxoffice-data for having the ability to use it as a number in the graph.   
We found out that movies are much more successful and have much more revenues:
All movies in Netflix have together more than 150B dollars of revenue, in the other side all series have less then 50B dollars together.
We also cheked the number of movies and Series and got that while there is more movies then series, the difference in the revenues is not explained only by that
```{r}
# convert the income to integer
Boxoffice_fixed <- surveys
Boxoffice_fixed$Boxoffice <- gsub("\\$", "", surveys$Boxoffice)
Boxoffice_fixed$Boxoffice <- gsub("\\,", "", Boxoffice_fixed$Boxoffice)
Boxoffice_fixed$Boxoffice <- as.numeric(Boxoffice_fixed$Boxoffice)
# Movie vs Series on boxoffice in Billion dollars
ggplot(Boxoffice_fixed,aes(`Series or Movie`,Boxoffice,fill = `Series or Movie`)) +
   geom_col() + scale_y_continuous(labels = label_number(suffix = " B", scale = 1e-9))+ 
  labs(title = "Movie Vs Series by Revenues in Bilion USD",
   x = "Revenues (USD)",y = "Movie or Series",) + theme_bw() 


Boxoffice_fixed_no_NA <- subset(Boxoffice_fixed, !is.na(Boxoffice))
ggplot(Boxoffice_fixed,aes(`Series or Movie`,fill=`Series or Movie`)) +  stat_count(geom = "bar") + theme_bw()
```

In this plot we want to check the correlation between the genre type to revenues 
in Billion dollars.
We used the same fixed dataset from the previous plot ("Boxoffice_fixed") with numeric values in Boxoffice column, we also edit the column of Genres - on many rows there were multiple genre in one row, so we keep in every row only the last Genre which appear in the end of every row. We also remove all rows with N/A values in genres and on Boxoffice.
We saw in the plot that according to the dataset That Thriller genre is has the biggest revenues, but we want to emphasize the point that on this dataset there are more than 10,000 movies without any data on their revenues at all (have N/A values)  
```{r}
###### יש בעיה גדולה באנליזה הזאת אנחנו משאירים את הזאנר הראשון ברשימה - אם למשל אקשן תמיד מופיע ראשון אז יהיה מלא אקשן למרות שלא בטוח שהוא הכי נפוץ
####  תיקנתי את זה!!!
### צריך לתקן את הטקסט למעלה שיתאים לממצאים החדשים
surveys_fixed_one_genre <- Boxoffice_fixed[!grepl(",", Boxoffice_fixed$Genre), ]
surveys_fixed_one_genre_no_NA_Genre <- subset(surveys_fixed_one_genre, !is.na(Genre))
surveys_fixed_one_genre_no_NA_Genre_Boxoffice<- subset(surveys_fixed_one_genre_no_NA_Genre, !is.na(Boxoffice))
# Revenues by Genres in Billion dollars 
ggplot(data = surveys_fixed_one_genre_no_NA_Genre_Boxoffice ,mapping = aes(x=Boxoffice, y= Genre, fill = Genre)) +
  geom_col() + 
  scale_x_continuous(labels = label_number(suffix = "B", scale = 1e-9))+ 
  labs(title = "Compare Revenues of all Genres in Bilion USD",
  y = "Genres", x = "Revenues (USD)")
```


############ FiX TEXT dou to results#################
On this plot we check the correlation between genre type and the real release date (not Netflix release date) of the movies/series.
we use the same fixed dataset from the previous plot - "surveys_fixed_no_NA_Genres"
and also use year column which we create from `Release date` column
We found out that on the last 20 years the biggest  increase is in Thriller, Drama, romance and comedy movies.
```{r}
# Sum of Genres per years
surveys_one_genre_fixed_date <- surveys[!grepl(",", Boxoffice_fixed$Genre), ]
surveys_one_genre_fixed_date <- surveys_one_genre_fixed_date %>% separate(`Release Date`, c("day", "month", "year"), sep = " ", convert = TRUE)
ggplot(surveys_fixed_one_genre_no_NA_Genre,aes(x = year, color = Genre)) + 
     geom_line(stat = 'count') +
  labs( title = "Sum of  genre over the years",
  y = "Genres", x = "Years") + coord_cartesian(xlim = c(2000, 2022))

```



